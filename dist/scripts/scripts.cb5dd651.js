"use strict";angular.module("nimbusEmrApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","firebase","firebase.ref","firebase.auth","apiMock","config","ui.bootstrap"]).config(["apiMockProvider",function(a){a.config({mockDataPath:"/mock-data/package",apiPath:"/where-ever-packages-comes-from"})}]),angular.module("nimbusEmrApp").controller("MainCtrl",["$rootScope","$scope","Auth","Ref",function(a,b,c,d){b.logout=function(){c.$unauth()}}]),angular.module("firebase.config",[]).constant("FBURL","https://nimbusemr.firebaseio.com").constant("SIMPLE_LOGIN_PROVIDERS",["password"]).constant("loginRedirectPath","/login"),angular.module("firebase.ref",["firebase","firebase.config"]).factory("Ref",["$window","FBURL",function(a,b){return new a.Firebase(b)}]),angular.module("nimbusEmrApp").filter("reverse",function(){return function(a){return angular.isArray(a)?a.slice().reverse():[]}}),angular.module("nimbusEmrApp").filter("highlight",["$sce",function(a){return function(b,c){return c&&(b=b.replace(new RegExp("("+c+")","gi"),'<span class="highlighted">$1</span>')),a.trustAsHtml(b)}}]),function(){angular.module("firebase.auth",["firebase","firebase.ref"]).factory("Auth",["$firebaseAuth","Ref",function(a,b){return a(b)}])}(),angular.module("nimbusEmrApp").controller("LoginCtrl",["$scope","Auth","$location","$q","Ref","$timeout",function(a,b,c,d,e,f){function g(a){return h(a.substr(0,a.indexOf("@"))||"")}function h(a){a+="";var b=a.charAt(0).toUpperCase();return b+a.substr(1)}function i(){c.path("/packages")}function j(b){a.err=b}a.passwordLogin=function(c,d){a.err=null,b.$authWithPassword({email:c,password:d},{rememberMe:!0}).then(i,j)},a.createAccount=function(c,h,k){function l(a){var b=e.child("users",a.uid),h=d.defer();return b.set({email:c,name:g(c)},function(a){f(function(){a?h.reject(a):h.resolve(b)})}),h.promise}a.err=null,h?h!==k?a.err="Passwords do not match":b.$createUser({email:c,password:h}).then(function(){return b.$authWithPassword({email:c,password:h},{rememberMe:!0})}).then(l).then(i,j):a.err="Please enter a password"}}]),angular.module("nimbusEmrApp").controller("ModalController",["$scope","$uibModalInstance","modalData",function(a,b,c){a.modalData=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},a.closeModal=function(){b.dismiss()}}]),angular.module("nimbusEmrApp").controller("TestCtrl",["$rootScope","$scope","$interval","Auth","Ref",function(a,b,c,d,e){var f,g="user1",h=e.child(g+"/vitals/hr"),i=!1;b.hr={},h.on("value",function(a){console.log("HR obtained",a.val()),b.hr.value=a.val().value,b.hr.unitOfMeasure=a.val().unitOfMeasure},function(a){console.log("The read failed: "+a.code)}),b.logout=function(){d.$unauth()},b.startDemo=function(){i===!1&&(i=!0,f=c(function(){h.set({value:Math.floor(160*Math.random()+40),unitOfMeasure:"bpm"})},1e3))},b.stopDemo=function(){i===!0&&(i=!1,c.cancel(f),f=void 0)}}]),angular.module("nimbusEmrApp").controller("SessionController",["$rootScope","$scope","$interval","Auth","Ref","VitalsSim","$firebaseArray",function(a,b,c,d,e,f,g){b.hr=[],b.sp02=[],b.etc02=[],b.resp=[];var h="user1",i=e.child(h+"/vitals/hr"),j=e.child(h+"/vitals/sp02"),k=e.child(h+"/vitals/etc02"),l=e.child(h+"/vitals/resp");g(i).$loaded().then(function(a){console.log("HR updated",a),b.hr=a}),g(j).$loaded().then(function(a){console.log("SP02 updated",a),b.sp02=a}),g(k).$loaded().then(function(a){console.log("ETC02 updated",a),b.etc02=a}),g(l).$loaded().then(function(a){console.log("Resp updated",a),b.resp=a}),b.startSim=function(){f.startDemo(e)},b.stopSim=function(){f.stopDemo()},b.clearData=function(){i.remove(),j.remove(),k.remove(),l.remove()}}]),angular.module("nimbusEmrApp").factory("VitalsSim",["$rootScope","$interval","$firebaseArray",function(a,b,c){var d,e={startDemo:function(a){var e="user1",f=a.child(e+"/vitals/hr"),g=c(f),h=a.child(e+"/vitals/sp02"),i=c(h),j=a.child(e+"/vitals/etc02"),k=c(j),l=a.child(e+"/vitals/resp"),m=c(l);d=b(function(){g.$add({value:Math.floor(190*Math.random()+85),unitOfMeasure:"bpm"}),i.$add({value:Math.floor(100*Math.random()+85),unitOfMeasure:"%"}),k.$add({value:Math.floor(100*Math.random()+85),unitOfMeasure:"%"}),m.$add({value:Math.floor(20*Math.random()+1),unitOfMeasure:"bpm"})},1e3)},stopDemo:function(){b.cancel(d),d=void 0}};return e}]),angular.module("nimbusEmrApp").directive("ngShowAuth",["Auth","$timeout",function(a,b){return{restrict:"A",link:function(c,d){function e(){b(function(){d.toggleClass("ng-cloak",!a.$getAuth())},0)}d.addClass("ng-cloak"),a.$onAuth(e),e()}}}]),angular.module("nimbusEmrApp").directive("ngHideAuth",["Auth","$timeout",function(a,b){return{restrict:"A",link:function(c,d){function e(){b(function(){d.toggleClass("ng-cloak",!!a.$getAuth())},0)}d.addClass("ng-cloak"),a.$onAuth(e),e()}}}]),angular.module("nimbusEmrApp").config(["$routeProvider","SECURED_ROUTES",function(a,b){a.whenAuthenticated=function(c,d){return d.resolve=d.resolve||{},d.resolve.user=["Auth",function(a){return a.$requireAuth()}],a.when(c,d),b[c]=!0,a}}]).config(["$routeProvider",function(a){a.when("/main",{templateUrl:"views/session.html",controller:"SessionController"}).when("/test",{templateUrl:"views/test.html",controller:"TestCtrl"}).otherwise({redirectTo:"/main"})}]).constant("SECURED_ROUTES",{}),angular.module("config",[]).constant("MockData",!1);